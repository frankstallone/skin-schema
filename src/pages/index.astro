---
import { getImage } from 'astro:assets';
import { getCollection } from 'astro:content';
import Layout from '../layouts/Layout.astro';
import Header from '../components/Header.astro';
const allPosts = (await getCollection('blog')).sort(
  (a, b) => b.data.publishDate.valueOf() - a.data.publishDate.valueOf(),
);
// TODO: Create better meta tags for home page

import hero from '../assets/2023-Creative-Minds-29-web.jpg';

const optimizedBackground = await getImage({ src: hero, format: 'webp' });
---

<Layout
  meta={{
    title: 'Skin Schema | Home',
    description: 'Skin Schema',
  }}
>
  <a href="#main" class="sr-only sr-only-focusable">Skip to content</a>
  <main>
    <Header />
    <div
      style={`background-image: url(${optimizedBackground.src}); background-size: cover; padding-block: var(--space-3xl-4xl); background-position: center;`}
    >
      <div class="wrapper region">
        <h1 class="mt-zero text-gray-400">Natural beauty routine tips</h1>
      </div>
    </div>
    <section class="wrapper" id="main">
      {
        allPosts.map((post) => (
          <div
            class="region flow prose"
            style="--region-space: var(--space-s-m);"
          >
            <p class="font-mono font-semibold mt-zero text-gray-900">
              From the blog
            </p>
            <h2>
              <a class="button" href={`/${post.slug}/`}>
                {post.data.title}
              </a>
            </h2>
            <p class="mt-zero">
              <small class="font-mono text-gray-900">
                {new Date(post.data.publishDate).toLocaleDateString(undefined, {
                  weekday: 'long',
                  year: 'numeric',
                  month: 'long',
                  day: 'numeric',
                })}
              </small>
            </p>
            <p>{post.data.description}</p>
            <p>
              <a href={`/${post.slug}/`}>Read more &hellip;</a>
            </p>
          </div>
        ))
      }
    </section>
  </main>
</Layout>
